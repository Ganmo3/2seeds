<div class="d-flex align-items-center justify-content-between mt-5">
  <button id="preview-button" type="button" class="preview-btn">Preview</button>
    <div id="link-message" class="link-message">リンクを入れてください。</div>
  <div class="form-group_button-wrapper d-flex align-items-center">
    <div class="toggle_switch mr-3">
      <input type="checkbox" id="postTypeToggle" class="toggle_input">
      <label for="postTypeToggle" class="toggle_label"></label>
    </div>
    <div class="btn-group" role="group">
      <% if @post.persisted? %>
        <%= f.submit '更新する', id: 'updateButton', name: 'commit', class: "submit-btn" %>
      <% else %>
        <%= f.submit '投稿する', id: 'postButton', name: 'commit', class: "submit-btn" %>
        <%= f.submit '下書き保存', id: 'draftButton', name: 'commit', class: "draft-btn" %>
      <% end %>
    </div>
  </div>
</div>


<div class="form-group form-group_link mt-4">
  <%= f.label :link, "Link", class: "form-label" %>
  <%= f.text_field :link, required: true, class: 'form-control post_link' %>
</div>

<div class="form-group form-group_tags">
  <%= f.label :tag_list, "Tags", class: "form-label" %>
  <%= f.text_field :tag_list, class: "form-control", data: { role: "tagsinput" } %>
</div>

<div class="form-group form-group_title">
  <%= f.label :title, "Title", class: "form-label" %>
  <%= f.text_field :title, required: true, class: 'form-control post_title' %>
</div>

<div class="form-group form-group_body">
  <%= f.label :body, "Body", class: "form-label" %>
  <%= f.rich_text_area :body, required: true %>
</div>








<!-- プレビューのモーダルウィンドウ -->
<div id="preview-modal" class="modal">
  <div class="modal-content"></div>
</div>

<script>
  $(document).ready(function() {
    $('#preview-button').click(function() {
      var formData = {
        link: $('#post_link').val(),
        tag_list: $('#post_tag_list').val(),
        title: $('#post_title').val(),
        body: $('#post_body').val()
        // 他のフォームフィールドも同様に追加
      };

      $.ajax({
        url: '<%= preview_posts_path %>',
        type: 'POST',
        data: { post: formData },
        success: function(response) {
          $('#preview-modal .modal-content').html(response);
          $('#preview-modal').addClass('fade-in').show();
        }
      });
    });

    $('#preview-modal').on('click', function() {
      $(this).addClass('fade-out');
      setTimeout(() => {
        $(this).hide().removeClass('fade-out');
      }, 300); // アニメーションの時間に合わせて調整
    });

    $('#postTypeToggle').change(function() {
      if ($(this).is(':checked')) {
        $('#postButton').show();
        $('#draftButton').hide();
        $('#updateButton').prop('disabled', false).show();
      } else {
        $('#postButton').hide();
        $('#draftButton').show();
        $('#updateButton').prop('disabled', true).show();
      }
    });

    // 初期表示時の設定
    if ($('#postTypeToggle').is(':checked')) {
      $('#postButton').show();
      $('#draftButton').hide();
      $('#updateButton').prop('disabled', false).show();
    } else {
      $('#postButton').hide();
      $('#draftButton').show();
      $('#updateButton').prop('disabled', true).show();
    }
  });
</script>